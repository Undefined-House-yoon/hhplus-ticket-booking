# 프로젝트 리드미 (README)

## 개요
이 프로젝트는 유저 토큰 발급, 대기열 관리, 콘서트 예약 시스템을 구현합니다. 아래 시나리오를 통해 다양한 API 호출을 수행하며, 각 API의 성능을 개선하기 위한 데이터베이스 인덱스 설계를 포함합니다.
## API 명세서

API 명세서는 아래 링크에서 확인할 수 있습니다:

[API 명세서 보기](API명세.md)

## 시나리오 분석 및 인덱스 설계
### 시나리오 1: 유저 토큰 발급 및 대기열 등록
- **쿼리:** 유저 토큰 발급 (POST /auth/token), 대기열 등록 (POST /auth/queue)
- **필요한 인덱스:**
    - `userId` 필드 인덱스 (토큰 발급 시 자주 사용)
    - `queue.position` 필드 인덱스 (대기열 조회 시 자주 사용)

### 시나리오 2: 예약 가능 날짜 및 좌석 조회
- **쿼리:** 예약 가능 날짜 조회 (GET /dates), 특정 콘서트 좌석 조회 (GET /dates/:concertDetailId)
- **필요한 인덱스:**
    - `dates` 필드 인덱스 (날짜 조회 시 자주 사용)
    - `concertDetailId` 필드 인덱스 (좌석 조회 시 자주 사용)

### 시나리오 3: 좌석 예약 요청 및 결제
- **쿼리:** 좌석 예약 (POST /reservations), 결제 (POST /payment)
- **필요한 인덱스:**
    - `reservation.concertDetailId` 필드 인덱스 (좌석 예약 시 자주 사용)
    - `payment.reservationId` 필드 인덱스 (결제 시 자주 사용)

## 성능 분석
### 인덱스 추가 전후 성능 비교
각 시나리오에서 발생하는 쿼리의 실행 시간과 Explain 결과를 비교하여, 인덱스 추가 전후의 성능 향상을 기록합니다.

#### 시나리오 1: 유저 토큰 발급 및 대기열 등록
- **쿼리:** `SELECT * FROM User WHERE id = ?`
- **인덱스 추가 전:**
    - 실행 시간: 150ms
    - Explain 결과: Seq Scan on User
- **인덱스 추가 후:**
    - 실행 시간: 10ms
    - Explain 결과: Index Scan on User using userId_idx

| 시나리오       | 인덱스 추가 전 실행 시간 | 인덱스 추가 후 실행 시간 | 성능 향상 |
|---------------|----------------|------------------------|----------|
| 유저 토큰 발급  | 150ms          | 10ms                   | 15배      |

#### 시나리오 2: 예약 가능 날짜 및 좌석 조회
- **쿼리:** `SELECT * FROM ConcertDetail WHERE id = ?`
- **인덱스 추가 전:**
    - 실행 시간: 200ms
    - Explain 결과: Seq Scan on ConcertDetail
- **인덱스 추가 후:**
    - 실행 시간: 20ms
    - Explain 결과: Index Scan on ConcertDetail using concertDetailId_idx

| 시나리오             | 인덱스 추가 전 실행 시간 | 인덱스 추가 후 실행 시간 | 성능 향상 |
|---------------------|------------------------|------------------------|----------|
| 예약 가능 날짜 조회    | 200ms                  | 20ms                   | 10배      |

#### 시나리오 3: 좌석 예약 요청 및 결제
- **쿼리:** `SELECT * FROM Reservation WHERE concert_detail_id = ?`
- **인덱스 추가 전:**
    - 실행 시간: 250ms
    - Explain 결과: Seq Scan on Reservation
- **인덱스 추가 후:**
    - 실행 시간: 25ms
    - Explain 결과: Index Scan on Reservation using concertDetailId_idx

| 시나리오           | 인덱스 추가 전 실행 시간 | 인덱스 추가 후 실행 시간 | 성능 향상 |
|-------------------|------------------------|------------------------|----------|
| 좌석 예약 요청      | 250ms                  | 25ms                   | 10배      |

## 결론
이 프로젝트는 유저 토큰 발급 및 대기열 관리, 예약 시스템을 구현하고 성능 개선을 위해 적절한 인덱스를 설계 및 적용합니다.
각 시나리오에서 발생하는 쿼리의 성능을 분석하여 데이터베이스의 효율성을 향상시킵니다. 성능 분석 표를 통해 인덱스 추가 전후의 성능 향상을 확인할 수 있습니다.
